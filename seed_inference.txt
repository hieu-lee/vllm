[
  "For any A,B>0, d∈\\mathbb{N}, and \\alpha\\in(0,1), one has \\(S_{A,B}(d+1,\\alpha)\\ge S_{A,B}(d,\\alpha)\\) if and only if \\(\\alpha^{d+1}\\ge\\dfrac{B}{\\,B+(A+Bd)(1-\\alpha)\\,}.\\)",
  "Let A,B>0 and α∈(0,1), and define S_{A,B}(d,α):=(1-α^{d+1})/((1-α)(A+Bd)) for d∈ℤ_{≥0}. If d^{*} maximizes S_{A,B}(d,α) over ℤ_{≥0}, then α^{d^{*}}(A(1-α)+B(d^{*}-(d^{*}-1)α))≥B≥α^{d^{*}+1}(A(1-α)+B(d^{*}+1-d^{*}α)), with equality in the left (resp. right) inequality if and only if S_{A,B}(d^{*},α)=S_{A,B}(d^{*}-1,α) (resp. S_{A,B}(d^{*}+1,α)=S_{A,B}(d^{*},α)). For the boundary case d^{*}=0, only the right inequality is required.",
  "If speculation is gated and triggered with probability $p$, then the expected arithmetic-ops factor per emitted token is at most $1+p\\,d(1+\\hat c)$. Therefore, a sufficient condition to satisfy an ops budget $B_{\\mathrm{ops}}>1$ is $d\\le \\big\\lfloor\\dfrac{B_{\\mathrm{ops}}-1}{p(1+\\hat c)}\\big\\rfloor$.",
  "Let A,B>0 and α∈(0,1), and define S_{A,B}(d,α):=(1−α^{d+1})/((1−α)(A+Bd)) for d∈ℤ_{≥0}. If d^* maximizes S_{A,B}(d,α) over ℤ_{≥0}, then B ≥ α^{d^*+1}(A(1−α)+B(d^*+1−d^*α)), and, if d^*≥1, also α^{d^*}(A(1−α)+B(d^*−(d^*−1)α)) ≥ B. Moreover, equality holds in α^{d^*}(A(1−α)+B(d^*−(d^*−1)α)) ≥ B if and only if d^*≥1 and S_{A,B}(d^*,α)=S_{A,B}(d^*−1,α), and equality holds in B ≥ α^{d^*+1}(A(1−α)+B(d^*+1−d^*α)) if and only if S_{A,B}(d^*+1,α)=S_{A,B}(d^*,α).",
  "(No-regret gating by acceptance thresholding) Consider a policy that at step $t$ speculates only if an unbiased estimate $\\hat{\\alpha}_t$ exceeds a draft/verify cost ratio $c\\ge 0$ (else it falls back to standard decoding). Then, relative to the baseline $t^{(1)}_{\\mathrm{target}}$, the expected time-per-token is never worse, and strictly improves whenever $\\mathbb P(\\hat{\\alpha}_t>c)>0$ and $\\mathbb E[\\,\\hat{\\alpha}_t- c\\mid \\hat{\\alpha}_t>c\\,]>0$. Formally, the expected speedup satisfies $\\mathbb{E}[\\mathrm{Speedup}_{\\mathrm{gate}}]\\ge 1$, with strict inequality under the stated condition.",
  "Given two drafters $(q^{(1)},\\alpha_1,c_1)$ and $(q^{(2)},\\alpha_2,c_2)$ and any $\\lambda\\in[0,1]$, form the fused draft $q_\\lambda=\\lambda q^{(1)}+(1-\\lambda)q^{(2)}$ at cost $c_{\\mathrm{fuse}}\\le \\lambda c_1+(1-\\lambda)c_2+\\delta$ for some overhead $\\delta\\ge0$. By concavity of acceptance, $\\alpha(q_\\lambda)\\ge \\lambda\\alpha_1+(1-\\lambda)\\alpha_2$, with equality iff almost surely over prefixes no coordinate of $q^{(1)}_t-p_t$ and $q^{(2)}_t-p_t$ has opposite sign; in particular, if $\\Pr(\\exists x:\\,(q^{(1)}_t(x)-p_t(x))(q^{(2)}_t(x)-p_t(x))<0)>0$, then $\\alpha(q_\\lambda)>\\lambda\\alpha_1+(1-\\lambda)\\alpha_2$. Consequently, for any fixed $d$, $$S\\big(d,\\alpha(q_\\lambda),c_{\\mathrm{fuse}}\\big)\\ge S\\big(d,\\lambda\\alpha_1+(1-\\lambda)\\alpha_2,\\,c_{\\mathrm{fuse}}\\big).$$ Moreover, there exists an open set of parameter values $(q^{(1)},q^{(2)},c_1,c_2,\\lambda)$ and sufficiently small $\\delta\\ge0$ for which $$S\\big(d,\\alpha(q_\\lambda),c_{\\mathrm{fuse}}\\big)\\;>\\;\\lambda S(d,\\alpha_1,c_1)+(1-\\lambda)S(d,\\alpha_2,c_2),$$ i.e., fusion can strictly dominate randomized gating.",
  "For fixed $A,B>0$ and $d\\in\\mathbb{N}$, the function $S_{A,B}(d,\\alpha)=\\dfrac{\\sum_{k=0}^{d}\\alpha^{k}}{A+Bd}$ satisfies $\\partial_\\alpha S_{A,B}=\\dfrac{\\sum_{k=1}^{d}k\\alpha^{k-1}}{A+Bd}$ and $\\partial_{\\alpha\\alpha} S_{A,B}=\\dfrac{\\sum_{k=2}^{d}k(k-1)\\alpha^{k-2}}{A+Bd}$. Hence on $\\alpha\\in[0,1)$: (i) $S_{A,B}(d,\\cdot)$ is $\\dfrac{d(d+1)}{2(A+Bd)}$–Lipschitz; (ii) if $d\\ge 2$, then $S_{A,B}(d,\\cdot)$ is $\\dfrac{2}{A+Bd}$–strongly convex (while for $d\\in\\{0,1\\}$ the strong convexity modulus is $0$).",
  "In the linearized self-speculation model with parameters $(A,B)=(1-r,r)$ for $r\\in(0,1)$, the maximal achievable speedup is $$\\sup_{d\\in\\mathbb{Z}_{\\ge 0},\\,\\alpha\\in(0,1)} S_{A,B}(d,\\alpha)=\\max\\Big\\{\\tfrac{1}{r},\\,\\tfrac{1}{1-r}\\Big\\}.$$. Moreover: (i) if $r>\\tfrac12$, the maximum $1/(1-r)$ is attained at $d=0$ for every $\\alpha\\in(0,1)$; (ii) if $r<\\tfrac12$, the supremum $1/r$ is not attained but is approached as $d\\to\\infty$ and $\\alpha\\uparrow 1$; (iii) if $r=\\tfrac12$, the value is $2$, attained at $d=0$ for every $\\alpha\\in(0,1)$ and approached for any fixed $d\\ge 1$ as $\\alpha\\uparrow 1$.",
  "Suppose verify latency scales as $t_{\\mathrm{target}}^{(d)}\\approx t_{\\mathrm{target}}^{(1)}\\bigl(1+\\gamma(d-1)\\bigr)$ with $0\\le\\gamma<1$, draft cost ratio $c\\ge0$, and acceptance mean $\\alpha\\in(0,1)$. Then with $A=1-\\gamma$ and $B=c+\\gamma$ the speedup is $$S_{A,B}(d,\\alpha)=\\frac{1-\\alpha^{d+1}}{(1-\\alpha)\\,(1-\\gamma+(c+\\gamma)d)}.$$. The continuous maximizer over $d\\ge0$ is $$d^{\\star}_{\\gamma,\\mathrm{cont}}=\\frac{-W\\!\\big(-e^{-b_{\\gamma}}\\big)-b_{\\gamma}}{L}-1,\\quad b_{\\gamma}:=1+\\frac{L(1-\\gamma)}{c+\\gamma}-L,\\quad L:=-\\ln\\alpha>0,$$ and $d^{\\star}_{\\gamma,\\mathrm{cont}}$ is nonincreasing in $\\gamma$ (hence the constrained maximizer over $\\mathbb{R}_{\\ge0}$ is also nonincreasing in $\\gamma$).",
  "Self-speculative decoding speedup in closed form. In self-speculative decoding with early exit at depth E of an L-layer target (so r:=E/L), the linearized parameters are A=1−r and B=r. For any 0<α<1 and integer d≥0, the predicted speedup is S_{\\mathrm{self}}(d,α,r)=\\dfrac{1-α^{d+1}}{(1-α)(1-r+rd)}. For the continuous maximizer over d≥0: if 0<r<1, let \\lambda:=-\\ln α and b_{\\mathrm{self}}:=1+\\dfrac{\\lambda(1-r)}{r}-\\lambda. When b_{\\mathrm{self}}\\ge 1, d^{\\star}_{\\mathrm{self,cont}}=\\max\\Big\\{\\dfrac{-W_{-1}\\!\\big(-\\mathrm e^{-b_{\\mathrm{self}}}\\big)-b_{\\mathrm{self}}}{\\lambda}-1,\\,0\\Big\\}; when b_{\\mathrm{self}}<1, d^{\\star}_{\\mathrm{self,cont}}=0. In the boundary cases, r=0 yields no finite maximizer with \\sup_{d\\ge 0}S_{\\mathrm{self}}(d,α,0)=\\tfrac{1}{1-α}, and r=1 yields no finite continuous maximizer with \\lim_{d\\to 0^+}S_{\\mathrm{self}}(d,α,1)=\\infty.",
  "(Self-speculative global speed ceiling and phase switch) For r∈(0,1) and self-speculation with (A,B)=(1−r,r), the supremum of the linearized speedup over d∈ℤ_{≥0} and α∈(0,1) is $$ \\\\sup_{d\\ge 0,\\,\\alpha\\in(0,1)} S_{A,B}(d,\\alpha)=\\max\\Big\\{\\frac{1}{r},\\,\\frac{1}{1-r}\\Big\\}. $$. Moreover, if r>1/2 the maximum 1/(1−r) is attained at d=0 (indeed S_{A,B}(0,\\alpha)\\equiv 1/(1−r)), whereas if r<1/2 the supremum 1/r is not attained for any finite d and α but is approached as d\\to\\infty and \\alpha\\uparrow 1.",
  "Fix A,B>0 and α∈(0,1). Define g(d)=(1-α^{d+1})/(A+Bd) for d≥0. Then g is strictly unimodal on [0,∞). Any interior stationary point must occur at z:=d+1 solving e^{L z}-L z=b, where L:=-\\rm{ln}\\,α>0 and b:=1+(LA)/B−L. This equation has at most one solution with z≥1; such a solution exists iff b≥e^{L}−L, in which case the continuous maximizer is d^{\\star}_{\\mathrm{cont}}=\\frac{-W_{-1}(-e^{-b})-b}{L}-1. Otherwise g is strictly decreasing and d^{\\star}_{\\mathrm{cont}}=0. Moreover, the discrete optimizer satisfies d^{\\star}∈{⌊d^{\\star}_{\\mathrm{cont}}⌋,⌈d^{\\star}_{\\mathrm{cont}}⌉}.",
  "(Monotone effect of reuse ratio at fixed depth) For fixed $\\alpha\\ge 0$ and integer $d\\ge 0$, the speedup $S_{\\mathrm{self}}(d,\\alpha,r)=\\dfrac{G_d(\\alpha)}{1-r+rd}$ satisfies $$\\partial_r S_{\\mathrm{self}}(d,\\alpha,r)=-\\dfrac{(d-1)\\,G_d(\\alpha)}{(1-r+rd)^2}$$ for all $r$ with $1-r+rd\\ne 0$. Hence $S_{\\mathrm{self}}(d,\\alpha,\\cdot)$ is strictly decreasing in $r$ for $d\\ge 2$, constant in $r$ for $d=1$, and strictly increasing in $r$ for $d=0$ on each connected component of its domain.",
  "Fix $r\\in(0,1)$ and an integer cap $D\\ge 0$. Then $$\\sup_{\\alpha\\in(0,1)}\\;\\sup_{0\\le d\\le D} S_{\\mathrm{self}}(d,\\alpha,r)=\\max\\Big\\{\\dfrac{D+1}{1-r+rD},\\;\\dfrac{1}{1-r}\\Big\\}.$$ A maximizing depth is $d=D$ when $r<\\tfrac12$ and $d=0$ when $r\\ge\\tfrac12$; the switch point $r=\\tfrac12$ is independent of $D$.",
  "Near-$\\alpha=1$ scaling of the continuous maximizer. Let $A,B>0$ and let $d^{\\star}_{\\mathrm{cont}}(\\alpha;A,B)$ be the maximizer of $S_{A,B}(d,\\alpha)$ over $d\\ge 0$. As $\\alpha\\uparrow 1$ with $L:=-\\ln\\alpha\\downarrow 0$, one has\n\\[ d^{\\star}_{\\mathrm{cont}}(\\alpha;A,B)=\\begin{cases}0, & A\\le B,\\\\[4pt]\n\\displaystyle \\frac{\\sqrt{2\\,(A/B-1)}}{\\sqrt{L}}-1+\\mathcal O(1), & A>B.\\end{cases} \\]",
  "Falsehood of the factor-2 threshold and a corrected sufficient condition. Let a:=A/B>1. There is no d_0 such that for all integers d\\ge d_0 one has \\bigl[\\alpha\\ge 1-\\tfrac{2(a-1)}{d^2}\\bigr]\\Rightarrow S_{A,B}(d{+}1,\\alpha)\\ge S_{A,B}(d,\\alpha); in fact, for all sufficiently large d, at \\alpha=1-\\tfrac{2(a-1)}{d^2} one has S_{A,B}(d{+}1,\\alpha)<S_{A,B}(d,\\alpha). Moreover, a valid uniform sufficient condition is \\alpha\\ge 1-\\dfrac{a-1}{(d+1)(d+a)}\\Rightarrow S_{A,B}(d{+}1,\\alpha)\\ge S_{A,B}(d,\\alpha). Consequently, for any finite cap D\\in\\mathbb N, if \\alpha\\ge 1-\\dfrac{a-1}{D(D+a)}, then S_{A,B}(d{+}1,\\alpha)\\ge S_{A,B}(d,\\alpha) for all integers d\\in\\{0,1,\\dots,D-1\\}, so the best budget-feasible depth is d=D.",
  "Ops-budget–optimal gating probability. Fix A,B>0, d∈ℤ_{≥0}, α∈(0,1), and a mixture-of-modes gate that triggers speculation with probability p∈[0,1]. The expected speed factor is Spd_gate(p; d, α)=1+p(S_{A,B}(d,α)−1), and the expected ops factor is at most 1+p d(1+\\hat c).\n\nLet B_ops≥1 and define the ops-feasible upper bound on p by\n- p_max=1 if d=0,\n- p_max=min{1, (B_ops−1)/(d(1+\\hat c))} if d≥1.\n\nThen, over p∈[0,p_max], the mixture-of-modes gate maximizes speed at\n- p^{mix,*}=0 if S_{A,B}(d,α)<1,\n- any p∈[0,p_max] if S_{A,B}(d,α)=1,\n- p^{mix,*}=p_max if S_{A,B}(d,α)>1.\nIn particular, its optimal speed is at least 1+p_max(S_{A,B}(d,α)−1).\n\nIf, in addition, speculation is triggered only when an independent no-regret acceptance threshold selects T=1 (so that E[T·Δ]≥0 with Δ:=S_{A,B}(d,α)−1), then the expected speed is 1+p E[T·Δ], the expected ops factor remains ≤1+p d(1+\\hat c), and the ops-budget–optimal choice saturates the budget: p^*=p_max. With this choice, the expected speed is at least 1, so the combined policy never underperforms the baseline.",
  "Let A,B>0. For each d∈ℤ≥0, define α^{\\mathrm{crit}}_{A,B}(d) as follows: if there exists α∈(0,1) with \\(\\displaystyle \\frac{\\alpha^{d+1}}{\\sum_{k=0}^{d}\\alpha^k}=\\frac{B}{A+Bd}\\), take the unique such α; otherwise set α^{\\mathrm{crit}}_{A,B}(d):=1. Then α^{\\mathrm{crit}}_{A,B}(d)∈(0,1], α^{\\mathrm{crit}}_{A,B}(0)=\\min\\{B/A,1\\}; the map d\\mapsto α^{\\mathrm{crit}}_{A,B}(d) is nondecreasing and is strictly increasing whenever α^{\\mathrm{crit}}_{A,B}(d)<1 (in particular, if B<A then α^{\\mathrm{crit}}_{A,B}(d)∈(0,1) for all d and is strictly increasing, while if B\\ge A then α^{\\mathrm{crit}}_{A,B}(d)\\equiv 1); and \\(\\lim_{d\\to\\infty}α^{\\mathrm{crit}}_{A,B}(d)=1\\). Moreover, for every d and every α∈(0,1), \\(S_{A,B}(d{+}1,α)\\ge S_{A,B}(d,α)\\) iff \\(α\\ge α^{\\mathrm{crit}}_{A,B}(d)\\); at α=1 one has \\(S_{A,B}(d{+}1,1)\\ge S_{A,B}(d,1)\\) iff A\\ge B."
]

